{"version":3,"sources":["../../../../../lib/xlsx/xform/comment/vml-note-xform.js"],"names":["BaseXform","require","VmlAnchorXform","VmlNoteXform","xmlStream","model","index","openNode","V_SHAPE_ATTRIBUTES","leafNode","color2","color","obscured","style","closeNode","ObjectType","vmlAnchorXform","render","refAddress","row","col","module","exports","id","type","fillcolor","strokecolor"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,SAAS,GAAGC,OAAO,CAAC,eAAD,CAAzB;;AAEA,IAAMC,cAAc,GAAGD,OAAO,CAAC,oBAAD,CAA9B,C,CAEA;;;IACME,Y;;;;;;;;;;;;;2BAKGC,S,EAAWC,K,EAAOC,K,EAAO;AAC9BF,MAAAA,SAAS,CAACG,QAAV,CAAmB,SAAnB,EAA8BJ,YAAY,CAACK,kBAAb,CAAgCF,KAAhC,CAA9B;AAEAF,MAAAA,SAAS,CAACK,QAAV,CAAmB,QAAnB,EAA6B;AAACC,QAAAA,MAAM,EAAE;AAAT,OAA7B;AACAN,MAAAA,SAAS,CAACK,QAAV,CAAmB,UAAnB,EAA+B;AAACE,QAAAA,KAAK,EAAE,WAAR;AAAqBC,QAAAA,QAAQ,EAAE;AAA/B,OAA/B;AACAR,MAAAA,SAAS,CAACK,QAAV,CAAmB,QAAnB,EAA6B;AAAC,yBAAiB;AAAlB,OAA7B;AAEAL,MAAAA,SAAS,CAACG,QAAV,CAAmB,WAAnB,EAAgC;AAACM,QAAAA,KAAK,EAAE;AAAR,OAAhC;AACAT,MAAAA,SAAS,CAACK,QAAV,CAAmB,KAAnB,EAA0B;AAACI,QAAAA,KAAK,EAAE;AAAR,OAA1B;AACAT,MAAAA,SAAS,CAACU,SAAV;AAEAV,MAAAA,SAAS,CAACG,QAAV,CAAmB,cAAnB,EAAmC;AAACQ,QAAAA,UAAU,EAAE;AAAb,OAAnC;AACAX,MAAAA,SAAS,CAACK,QAAV,CAAmB,iBAAnB;AACAL,MAAAA,SAAS,CAACK,QAAV,CAAmB,iBAAnB;AAEAN,MAAAA,YAAY,CAACa,cAAb,CAA4BC,MAA5B,CAAmCb,SAAnC,EAA8CC,KAA9C;AAEAD,MAAAA,SAAS,CAACK,QAAV,CAAmB,YAAnB,EAAiC,IAAjC,EAAuC,OAAvC;AACAL,MAAAA,SAAS,CAACK,QAAV,CAAmB,OAAnB,EAA4B,IAA5B,EAAkCJ,KAAK,CAACa,UAAN,CAAiBC,GAAjB,GAAuB,CAAzD;AACAf,MAAAA,SAAS,CAACK,QAAV,CAAmB,UAAnB,EAA+B,IAA/B,EAAqCJ,KAAK,CAACa,UAAN,CAAiBE,GAAjB,GAAuB,CAA5D;AACAhB,MAAAA,SAAS,CAACU,SAAV;AAEAV,MAAAA,SAAS,CAACU,SAAV;AACD;;;wBA3BS;AACR,aAAO,SAAP;AACD;;;;EAHwBd,S;;AA+B3BqB,MAAM,CAACC,OAAP,GAAiBnB,YAAjB;;AAEAA,YAAY,CAACK,kBAAb,GAAkC,UAAAF,KAAK;AAAA,SAAK;AAC1CiB,IAAAA,EAAE,oBAAa,OAAOjB,KAApB,CADwC;AAE1CkB,IAAAA,IAAI,EAAE,cAFoC;AAG1CX,IAAAA,KAAK,EAAE,iHAHmC;AAI1CY,IAAAA,SAAS,EAAE,qBAJ+B;AAK1CC,IAAAA,WAAW,EAAE,WAL6B;AAM1C,mBAAe;AAN2B,GAAL;AAAA,CAAvC;;AASAvB,YAAY,CAACa,cAAb,GAA8B,IAAId,cAAJ,EAA9B","sourcesContent":["const BaseXform = require('../base-xform');\n\nconst VmlAnchorXform = require('./vml-anchor-xform');\n\n// render the triangle in the cell for the comment\nclass VmlNoteXform extends BaseXform {\n  get tag() {\n    return 'v:shape';\n  }\n\n  render(xmlStream, model, index) {\n    xmlStream.openNode('v:shape', VmlNoteXform.V_SHAPE_ATTRIBUTES(index));\n\n    xmlStream.leafNode('v:fill', {color2: 'infoBackground [80]'});\n    xmlStream.leafNode('v:shadow', {color: 'none [81]', obscured: 't'});\n    xmlStream.leafNode('v:path', {'o:connecttype': 'none'});\n\n    xmlStream.openNode('v:textbox', {style: 'mso-direction-alt:auto'});\n    xmlStream.leafNode('div', {style: 'text-align:left'});\n    xmlStream.closeNode();\n\n    xmlStream.openNode('x:ClientData', {ObjectType: 'Note'});\n    xmlStream.leafNode('x:MoveWithCells');\n    xmlStream.leafNode('x:SizeWithCells');\n\n    VmlNoteXform.vmlAnchorXform.render(xmlStream, model);\n\n    xmlStream.leafNode('x:AutoFill', null, 'False');\n    xmlStream.leafNode('x:Row', null, model.refAddress.row - 1);\n    xmlStream.leafNode('x:Column', null, model.refAddress.col - 1);\n    xmlStream.closeNode();\n\n    xmlStream.closeNode();\n  }\n}\n\nmodule.exports = VmlNoteXform;\n\nVmlNoteXform.V_SHAPE_ATTRIBUTES = index => ({\n  id: `_x0000_s${1025 + index}`,\n  type: '#_x0000_t202',\n  style: 'position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden',\n  fillcolor: 'infoBackground [80]',\n  strokecolor: 'none [81]',\n  'o:insetmode': 'auto',\n});\n\nVmlNoteXform.vmlAnchorXform = new VmlAnchorXform();"],"file":"vml-note-xform.js"}